<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>龚哲炜 开发日志</title>
  <style>
    :root { --fg: #222; --muted: #666; --border: #cfcfcf; --bg-muted: #f6f6f6; }
    body { font-family: "Microsoft YaHei", "Noto Sans CJK SC", sans-serif; line-height: 1.9; margin: 32px; color: var(--fg); }
    h1, h2, h3, h4 { margin: 0 0 12px; }
    h1 { font-size: 26px; }
    h2 { font-size: 18px; margin-top: 26px; padding-top: 6px; border-top: 1px solid #eee; }
    h3 { font-size: 15px; margin-top: 18px; }
    h4 { font-size: 14px; margin-top: 14px; }
    p { margin: 10px 0; }
    ul, ol { margin: 8px 0 8px 22px; }
    li { margin: 4px 0; }
    pre { background: var(--bg-muted); padding: 12px; border-radius: 8px; overflow-x: auto; }
    code { background: var(--bg-muted); padding: 1px 4px; border-radius: 4px; }
    table { border-collapse: collapse; width: 100%; margin: 10px 0; }
    th, td { border: 1px solid var(--border); padding: 8px 10px; vertical-align: top; }
    th { background: #fafafa; }
    .muted { color: var(--muted); }
    .note { background: #fff7e6; padding: 10px 12px; border-left: 4px solid #f0b429; margin: 10px 0; }
    .callout { border-left: 4px solid #10b981; background: #ecfdf5; padding: 10px 12px; margin: 10px 0; }
  </style>
</head>
<body>
  <h1>个人开发日志（龚哲炜）</h1>
  <p class="muted">项目：轻写（QingXie）AI 辅助小说创作平台（前后端分离）</p>
  <p>身份：组员　　主要负责：前端页面、交互体验、接口联调、测试与展示素材整理</p>

  <h2>0. 前端开发准备（记录型说明）</h2>
  <p>
    前端采用基于 React 的工程体系（Next.js），页面以组件化方式组织，并使用 TailwindCSS 与 Shadcn/ui 保证整体视觉风格一致。
    我的工作目标是把“注册登录—进入工作台—作品与章节管理—设定与 AI 面板—导出”串成一条可演示、可长期使用的完整流程，
    同时补齐加载态、空状态、错误提示等细节，避免答辩演示时出现“无反馈/卡住”的体验问题。
  </p>
  <div class="note">截图建议：图1（前端启动成功的终端截图 + 首页打开截图）。</div>

  <h2>2025-12-18 开发记录（页面搭建 + 交互联动）</h2>
  <h3>1. 页面结构与导航梳理</h3>
  <p>
    我先把页面路径与用户流程固定下来：未登录状态提供首页与登录/注册入口；登录后进入写作工作台作为主页面。
    同时规划工作台的内部导航：写作区（编辑器）、作品库（作品管理）、资料/设定区（角色/大纲/世界观入口）。
    这样在答辩演示时能按清晰路线介绍系统功能。
  </p>
  <div class="note">截图建议：图2（页面路由与导航结构示意，可用截图或简图）。</div>

  <h3>2. 登录与注册页面交互</h3>
  <p>
    登录与注册是验收必查项。我按“表单输入 → 提交 → 加载提示 → 成功跳转/失败提示”实现交互闭环：
    输入框支持基本校验（空值、格式），提交时展示 loading 状态，失败时展示明确错误原因，避免用户不知道发生了什么。
  </p>
  <p>
    登录成功后进入工作台，并在后续调用作品、章节等接口时自动携带认证信息。为了避免因浏览器缓存导致状态错乱，
    我也在文档中加入了“清除 Cookie/固定 secret”的排查说明，方便验收现场快速处理。
  </p>
  <div class="note">截图建议：图3（注册成功提示与登录成功跳转截图）。</div>

  <h3>3. 写作工作台：作品选择、章节列表与编辑器</h3>
  <p>
    工作台页面是系统的核心，也是展示评分中“界面设计”和“完整性”的关键。实现时我按模块拆分：
    （1）作品列表/选择器：用于切换当前作品；（2）章节导航：展示章节列表、支持新建与排序；
    （3）编辑区：展示章节内容并支持保存；（4）侧边工具面板：放置 AI 与设定模块入口。
  </p>
  <p>
    为提高可用性，我重点处理了空状态与错误状态：当用户没有作品时提示“创建作品”；当作品没有章节时提示“新建章节”；
    当接口请求失败时弹出 toast，并引导用户重试或重新登录。
  </p>
  <p>
    在实现上，我把“数据加载”的触发点放在页面进入与作品切换时，并把鉴权失败（401）作为单独分支处理：当接口返回 401，
    说明用户未登录或会话失效，应当立刻跳转到登录页，而不是让页面抛异常。这样即使答辩现场出现登录状态变化，也能快速回到可用路径。
  </p>
  <pre><code>// 逻辑示意（与实际代码一致的处理思路）：
const res = await fetch('/api/novels')
if (!res.ok) {
  if (res.status === 401) window.location.href = '/auth/signin'
  else throw new Error('请求失败')
}
const data = await res.json()
setNovels(data.novels)</code></pre>
  <div class="note">截图建议：图4（无作品空状态截图）、图5（有作品有章节的工作台截图）。</div>

  <h3>4. 作品管理与资料区页面</h3>
  <p>
    作品库用于集中展示作品卡片信息（标题、更新时间、字数、章节数等），我调整了卡片信息密度与排版，让关键信息一眼可见；
    同时保证在作品数量较多时仍能滚动浏览，交互不拥挤。资料区则作为设定入口集合，便于用户从写作区快速跳转到设定维护。
  </p>
  <div class="note">截图建议：图6（作品库页面截图）、图7（资料区页面截图）。</div>

  <h3>5. 设定模块：角色/大纲/世界观</h3>
  <p>
    设定模块的重点是“编辑体验”：字段多、文本长，因此需要良好的表单布局、保存反馈与列表刷新。
    我在联动时重点确保：新增后立即刷新列表；编辑保存后更新时间正确；删除操作有确认提示，避免误删。
  </p>
  <div class="note">截图建议：图8（角色工作室：新增/编辑截图）、图9（章纲/世界观编辑截图）。</div>

  <h3>6. AI 工具面板：可见反馈与结果可用</h3>
  <p>
    AI 功能属于加分项，但也最容易在演示中出现“不出结果/不知是否在生成”的问题。因此我在 UI 上做了两点：
    第一是加载状态可见（生成中有明显提示）；第二是结果区域可复制、可插入，避免生成后用户还要手动整理。
    同时对“未配置 Key”的情况做友好提示，确保核心功能不被阻塞。
  </p>
  <div class="note">截图建议：图10（AI 面板生成中状态截图）、图11（生成结果展示截图）。</div>

  <h3>7. 导出功能与细节优化</h3>
  <p>
    导出功能用于把章节内容按顺序合并为 TXT/Markdown。为了保证导出可用，我在页面上加入明确按钮文案与提示，
    并在导出后给出可见反馈。对长内容章节也进行了简单验证，确保导出文件编码与换行正常。
  </p>

  <h3>8. 关键前端文件与模块定位（便于老师查阅）</h3>
  <p>
    前端为了降低维护成本，采用“页面层 + 组件层 + 工具层”的组织方式：页面只负责组合组件与编排交互，具体 UI 细节放在组件中，
    与后端交互的公共逻辑尽量抽到统一的请求封装中。下面列出几个与验收强相关的文件入口，便于快速定位实现。
  </p>
  <table>
    <thead><tr><th>功能</th><th>文件/目录</th><th>说明</th></tr></thead>
    <tbody>
      <tr><td>写作工作台页面</td><td><code>src/app/app/page.tsx</code></td><td>工作台总布局、作品/章节加载、工具面板入口</td></tr>
      <tr><td>登录/注册页面</td><td><code>src/app/auth/signin/page.tsx</code>、<code>src/app/auth/signup/page.tsx</code></td><td>表单交互、跳转、错误提示</td></tr>
      <tr><td>会话与鉴权</td><td><code>src/lib/auth.ts</code>、<code>src/lib/session.ts</code></td><td>登录配置、获取当前用户、token 管理</td></tr>
      <tr><td>API 请求封装</td><td><code>src/lib/fastapi.ts</code></td><td>统一构造后端 URL、附加 Authorization</td></tr>
      <tr><td>写作组件集合</td><td><code>src/components/workspace/</code></td><td>章节编辑器、角色/大纲/AI 面板等</td></tr>
    </tbody>
  </table>
  <div class="note">截图建议：图12（代码目录结构截图：src/app、src/components）。</div>

  <h3>9. 接口联调与浏览器 Network 调试记录</h3>
  <p>
    前端联调时，我主要通过浏览器开发者工具（Network 面板）定位问题：检查请求地址是否正确、是否携带 Authorization Header、响应状态码与响应体是否符合预期。
    对于 401/403 类型的鉴权问题，优先确认是否登录成功、是否携带 token；对于 500 类型问题，结合后端日志定位具体接口报错。
  </p>
  <p>常用检查点：</p>
  <ul>
    <li>请求是否命中正确的接口路径（如 /api/novels、/api/novels/{id}/chapters）。</li>
    <li>请求 Header 中是否包含认证信息（Bearer Token）。</li>
    <li>响应是否为 JSON，是否返回 success/错误信息（便于前端展示 toast）。</li>
    <li>当返回 401 时是否能引导用户回到登录页，避免页面报错中断。</li>
  </ul>
  <div class="note">截图建议：图13（Network 面板：一次成功请求与一次失败请求对比截图）。</div>

  <h3>10. 响应式与样式细节优化记录</h3>
  <p>
    为了提高“界面设计”评分，我对关键页面做了响应式适配：在桌面端使用更宽的工作台布局与侧边面板，在小屏幕下改为下拉选择器/折叠式布局，
    避免工具面板挤压编辑区域。同时统一按钮样式、表单间距与状态色（成功/失败/警告），让整体风格更一致。
  </p>
  <div class="note">截图建议：图14（同一页面在桌面端与小屏端的对比截图）。</div>

  <h2>2025-12-20 交付记录（测试、截图与文档配合）</h2>
  <h3>1. 前端自测清单</h3>
  <p>
    为了保证演示稳定，我按验收流程做了一轮自测，并记录容易出错的点：登录状态、接口错误、空数据状态、按钮交互是否有反馈、刷新后数据是否丢失等。
    自测时采用“从零开始”的方式：先清空浏览器缓存/无痕窗口 → 注册 → 登录 → 创建作品与章节 → 保存正文 → 添加设定 → 导出 →（可选）AI。
  </p>
  <div class="callout">
    自测结论：主流程可完整跑通；AI 功能在配置 Key 后可正常生成；未配置 Key 时提示明确，不影响其他功能。
  </div>

  <h3>2. 截图素材整理</h3>
  <p>
    根据老师文档要求，我整理了“最少截图集”，覆盖：首页、注册/登录、工作台总览、作品库、设定模块、AI 面板、导出结果与后端健康检查。
    这些截图可直接粘贴到系统使用说明文档中，形成完整的“截图 + 说明”验收材料。
  </p>
  <div class="note">截图建议：图15（导出文件内容截图）、图16（后端 /docs 或 /health 截图）。</div>

  <h2>问题记录与排查（简要）</h2>
  <p>
    前端联调过程中常见问题主要集中在两类：鉴权与接口错误。遇到 401 时，通常需要用户重新登录或清除旧 Cookie；
    遇到 500/非 JSON 返回时，通过浏览器 Network 面板查看响应体与状态码，结合后端日志定位原因。
    对于这些问题，我将排查思路写入使用部署文档，方便后续验收时快速处理。
  </p>

  <p class="muted">备注：本日志为“可提交版本”。如需更贴合个人实际开发过程，可补充更多截图（页面、Network、控制台日志等）。</p>
</body>
</html>
